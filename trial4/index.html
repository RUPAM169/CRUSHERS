<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tournament Manager</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    .card-hover {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .card-hover:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    
    .gradient-text {
      background: linear-gradient(135deg, currentColor 0%, currentColor 100%);
      -webkit-background-clip: text;
      background-clip: text;
    }
    
    .nav-item {
      transition: all 0.2s ease;
      cursor: pointer;
    }
    
    .nav-item:hover {
      transform: translateX(8px);
    }
    
    .badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 24px;
      height: 24px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      padding: 0 8px;
    }

    .match-date {
      font-size: 0.95rem;
      opacity: 0.78;
      margin-bottom: 12px;
    }

    /* Mobile Responsiveness */
    @media (max-width: 768px) {
      body {
        overflow-x: hidden;
      }
      .app-container {
        display: flex !important;
        flex-direction: column !important;
      }
      .sidebar {
        width: 100% !important;
        padding: 16px !important;
        border-right: none !important;
        border-bottom: 2px solid rgba(139, 92, 246, 0.1) !important;
        overflow-x: auto;
      }
      .sidebar nav {
        display: flex;
        gap: 8px;
        overflow-x: auto;
        padding-bottom: 8px;
      }
      .sidebar nav > div {
        white-space: nowrap;
        flex-shrink: 0;
      }
      .main-content {
        padding: 16px !important;
      }
      .p-8 {
        padding: 16px !important;
      }
      .grid-cols-1 {
        grid-template-columns: 1fr !important;
      }
      .lg\:col-span-1,
      .lg\:col-span-2,
      .lg\:col-span-3 {
        grid-column: auto !important;
      }
      .sticky {
        position: relative !important;
      }
    }

    @media (max-width: 640px) {
      .card-large {
        padding: 24px !important;
      }
      .form-container {
        padding: 20px !important;
      }
      /* Table grid responsiveness */
      .table-grid {
        grid-template-columns: 40px 1fr repeat(8, 60px) !important;
        gap: 8px !important;
      }
      .table-header-grid {
        grid-template-columns: 40px 1fr repeat(8, 60px) !important;
        padding: 16px 20px !important;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full">
  <div id="app" class="h-full w-full overflow-auto"></div>
  <script>
    const defaultConfig = {
      background_color: "#0f172a",
      surface_color: "#1e293b",
      text_color: "#f1f5f9",
      primary_action_color: "#8b5cf6",
      secondary_action_color: "#06b6d4",
      font_family: "Space Grotesk",
      font_size: 16,
      platform_title: "Tournament Manager",
      welcome_message: "Organize and manage your tournaments"
    };

    let allData = [];
    let currentView = 'dashboard';
    let selectedTournamentId = null;
    let tournaments = [];
    let teams = [];
    let matches = [];

    const dataHandler = {
      onDataChanged(data) {
        allData = data;
        tournaments = data.filter(item => item.type === 'tournament');
        teams = data.filter(item => item.type === 'team');
        matches = data.filter(item => item.type === 'match');
        renderApp();
      }
    };

    async function initializeApp() {
      const initResult = await window.dataSdk.init(dataHandler);
      if (!initResult.isOk) {
        console.error("Failed to initialize data SDK");
        return;
      }

      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (config) => {
            renderApp();
          },
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.background_color || defaultConfig.background_color,
                set: (value) => {
                  config.background_color = value;
                  window.elementSdk.setConfig({ background_color: value });
                }
              },
              {
                get: () => config.surface_color || defaultConfig.surface_color,
                set: (value) => {
                  config.surface_color = value;
                  window.elementSdk.setConfig({ surface_color: value });
                }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => {
                  config.text_color = value;
                  window.elementSdk.setConfig({ text_color: value });
                }
              },
              {
                get: () => config.primary_action_color || defaultConfig.primary_action_color,
                set: (value) => {
                  config.primary_action_color = value;
                  window.elementSdk.setConfig({ primary_action_color: value });
                }
              },
              {
                get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
                set: (value) => {
                  config.secondary_action_color = value;
                  window.elementSdk.setConfig({ secondary_action_color: value });
                }
              }
            ],
            borderables: [],
            fontEditable: {
              get: () => config.font_family || defaultConfig.font_family,
              set: (value) => {
                config.font_family = value;
                window.elementSdk.setConfig({ font_family: value });
              }
            },
            fontSizeable: {
              get: () => config.font_size || defaultConfig.font_size,
              set: (value) => {
                config.font_size = value;
                window.elementSdk.setConfig({ font_size: value });
              }
            }
          }),
          mapToEditPanelValues: (config) => new Map([
            ["platform_title", config.platform_title || defaultConfig.platform_title],
            ["welcome_message", config.welcome_message || defaultConfig.welcome_message]
          ])
        });
      }

      renderApp();
    }

    function formatMatchDate(dateStr) {
      if (!dateStr) return '';
      try {
        const d = new Date(dateStr);
        return d.toLocaleString();
      } catch (e) {
        return '';
      }
    }

    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }

    function renderApp() {
      const config = window.elementSdk?.config || defaultConfig;
      const bgColor = config.background_color || defaultConfig.background_color;
      const surfaceColor = config.surface_color || defaultConfig.surface_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const primaryColor = config.primary_action_color || defaultConfig.primary_action_color;
      const secondaryColor = config.secondary_action_color || defaultConfig.secondary_action_color;
      const fontFamily = config.font_family || defaultConfig.font_family;
      const fontSize = config.font_size || defaultConfig.font_size;
      const platformTitle = config.platform_title || defaultConfig.platform_title;
      const welcomeMessage = config.welcome_message || defaultConfig.welcome_message;

      const app = document.getElementById('app');
      app.style.backgroundColor = bgColor;
      app.style.fontFamily = `${fontFamily}, system-ui, -apple-system, sans-serif`;

      const pendingMatches = matches.filter(m => m.status !== 'completed');
      const completedMatches = matches.filter(m => m.status === 'completed');

      let mainContent = '';

      if (currentView === 'dashboard') {
        mainContent = `
          <div class="p-8">
            <div class="mb-12">
              <h1 style="font-size: ${fontSize * 3}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 800; margin-bottom: 12px; letter-spacing: -0.02em;">${platformTitle}</h1>
              <p style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6;">${welcomeMessage}</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-12">
              <div style="background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); padding: 32px; border-radius: 20px; position: relative; overflow: hidden;">
                <div style="position: absolute; top: -20px; right: -20px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
                <div style="font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; opacity: 0.9; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 600;">Tournaments</div>
                <div style="font-size: ${fontSize * 3}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; font-weight: 800;">${tournaments.length}</div>
              </div>

              <div style="background-color: ${surfaceColor}; padding: 32px; border-radius: 20px; border: 2px solid rgba(139, 92, 246, 0.2);">
                <div style="font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 600;">Teams</div>
                <div style="font-size: ${fontSize * 3}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${primaryColor}; font-weight: 800;">${teams.length}</div>
              </div>

              <div style="background-color: ${surfaceColor}; padding: 32px; border-radius: 20px; border: 2px solid rgba(6, 182, 212, 0.2);">
                <div style="font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 600;">Matches</div>
                <div style="font-size: ${fontSize * 3}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${secondaryColor}; font-weight: 800;">${matches.length}</div>
              </div>

              <div style="background-color: ${surfaceColor}; padding: 32px; border-radius: 20px; border: 2px solid rgba(139, 92, 246, 0.2);">
                <div style="font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 600;">Completed</div>
                <div style="font-size: ${fontSize * 3}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${primaryColor}; font-weight: 800;">${completedMatches.length}</div>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="card-hover" onclick="switchView('tournaments')" style="background-color: ${surfaceColor}; padding: 40px; border-radius: 24px; cursor: pointer; border: 2px solid transparent; position: relative; overflow: hidden;">
                <div style="position: absolute; top: 0; right: 0; width: 120px; height: 120px; background: ${primaryColor}; opacity: 0.1; border-radius: 0 0 0 100%;"></div>
                <div style="font-size: ${fontSize * 3.5}px; margin-bottom: 16px;">ğŸ†</div>
                <h3 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px;">Tournaments</h3>
                <p style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; line-height: 1.6;">Create and organize competitive tournaments</p>
              </div>

              <div class="card-hover" onclick="switchView('teams')" style="background-color: ${surfaceColor}; padding: 40px; border-radius: 24px; cursor: pointer; border: 2px solid transparent; position: relative; overflow: hidden;">
                <div style="position: absolute; top: 0; right: 0; width: 120px; height: 120px; background: ${secondaryColor}; opacity: 0.1; border-radius: 0 0 0 100%;"></div>
                <div style="font-size: ${fontSize * 3.5}px; margin-bottom: 16px;">ğŸ‘¥</div>
                <h3 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px;">Teams</h3>
                <p style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; line-height: 1.6;">Register teams and manage rosters</p>
              </div>

              <div class="card-hover" onclick="switchView('schedule')" style="background-color: ${surfaceColor}; padding: 40px; border-radius: 24px; cursor: pointer; border: 2px solid transparent; position: relative; overflow: hidden;">
                <div style="position: absolute; top: 0; right: 0; width: 120px; height: 120px; background: ${primaryColor}; opacity: 0.1; border-radius: 0 0 0 100%;"></div>
                <div style="font-size: ${fontSize * 3.5}px; margin-bottom: 16px;">ğŸ“…</div>
                <h3 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px;">Schedule</h3>
                <p style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; line-height: 1.6;">Generate and view match schedules</p>
              </div>

              <div class="card-hover" onclick="switchView('results')" style="background-color: ${surfaceColor}; padding: 40px; border-radius: 24px; cursor: pointer; border: 2px solid transparent; position: relative; overflow: hidden;">
                <div style="position: absolute; top: 0; right: 0; width: 120px; height: 120px; background: ${secondaryColor}; opacity: 0.1; border-radius: 0 0 0 100%;"></div>
                <div style="font-size: ${fontSize * 3.5}px; margin-bottom: 16px;">ğŸ“Š</div>
                <h3 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px;">Results</h3>
                <p style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; line-height: 1.6;">Track and update match results</p>
              </div>

              <div class="card-hover" onclick="switchView('pointstable')" style="background-color: ${surfaceColor}; padding: 40px; border-radius: 24px; cursor: pointer; border: 2px solid transparent; position: relative; overflow: hidden;">
                <div style="position: absolute; top: 0; right: 0; width: 120px; height: 120px; background: ${primaryColor}; opacity: 0.1; border-radius: 0 0 0 100%;"></div>
                <div style="font-size: ${fontSize * 3.5}px; margin-bottom: 16px;">ğŸ…</div>
                <h3 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px;">Points Table</h3>
                <p style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; line-height: 1.6;">View team rankings and standings</p>
              </div>
            </div>
          </div>
        `;
      } else if (currentView === 'tournaments') {
        const selectedTournament = selectedTournamentId ? tournaments.find(t => t.id === selectedTournamentId) : null;
        
        mainContent = `
          <div class="p-8">
            ${selectedTournament ? `
              <div style="background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); padding: 32px; border-radius: 24px; margin-bottom: 32px; position: relative; overflow: hidden;">
                <div style="position: absolute; top: -40px; right: -40px; width: 200px; height: 200px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
                <div style="position: relative; z-index: 1;">
                  <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
                    <div>
                      <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; opacity: 0.8; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 600;">Selected Tournament</div>
                      <h3 style="font-size: ${fontSize * 2.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; font-weight: 800; margin-bottom: 8px;">ğŸ† ${selectedTournament.tournament_name}</h3>
                      <div style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; opacity: 0.8;">ğŸ“… Created ${new Date(selectedTournament.created_at).toLocaleDateString()}</div>
                    </div>
                    <button onclick="clearTournamentSelection()" style="background-color: rgba(255,255,255,0.2); color: white; padding: 12px 24px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3); cursor: pointer; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 600; transition: all 0.2s;" onmouseover="this.style.backgroundColor='rgba(255,255,255,0.3)'" onmouseout="this.style.backgroundColor='rgba(255,255,255,0.2)'">View All</button>
                  </div>
                </div>
              </div>
            ` : ''}
            
            <div class="mb-8">
              <h2 style="font-size: ${fontSize * 2.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 800; margin-bottom: 8px;">ğŸ† Tournaments</h2>
              <p style="font-size: ${fontSize * 1.125}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6;">Manage your competitive events</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
              <div class="lg:col-span-1">
                <div style="background-color: ${surfaceColor}; padding: 32px; border-radius: 24px; border: 2px solid rgba(139, 92, 246, 0.2); position: sticky; top: 20px;">
                  <h3 style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 24px;">Create Tournament</h3>
                  <form id="tournament-form" onsubmit="handleTournamentSubmit(event)">
                    <label for="tournament-name" style="display: block; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8;">Tournament Name</label>
                    <input type="text" id="tournament-name" required style="width: 100%; padding: 16px; background-color: ${bgColor}; border: 2px solid rgba(139, 92, 246, 0.3); border-radius: 12px; margin-bottom: 24px; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; transition: all 0.2s;" onfocus="this.style.borderColor='${primaryColor}'" onblur="this.style.borderColor='rgba(139, 92, 246, 0.3)'">
                    
                    <label for="tournament-logo" style="display: block; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8;">Tournament Logo</label>
                    <input type="file" id="tournament-logo" accept="image/*" style="width: 100%; padding: 12px; background-color: ${bgColor}; border: 2px solid rgba(139, 92, 246, 0.3); border-radius: 12px; margin-bottom: 24px; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor};">
                    
                    <button type="submit" id="tournament-submit-btn" style="width: 100%; background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); color: white; padding: 16px 32px; border-radius: 12px; border: none; cursor: pointer; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 700; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">Create Tournament</button>
                  </form>
                </div>
              </div>

              <div class="lg:col-span-2">
                ${tournaments.length === 0 ? `
                  <div style="background-color: ${surfaceColor}; padding: 80px 40px; border-radius: 24px; text-align: center; border: 2px dashed rgba(139, 92, 246, 0.3);">
                    <div style="font-size: ${fontSize * 5}px; margin-bottom: 24px; opacity: 0.5;">ğŸ†</div>
                    <h4 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px;">No Tournaments Yet</h4>
                    <p style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6;">Create your first tournament to get started</p>
                  </div>
                ` : `
                  <div class="space-y-4">
                    ${tournaments.map(tournament => `
                      <div class="card-hover" style="background-color: ${surfaceColor}; padding: 32px; border-radius: 20px; border: 2px solid ${selectedTournamentId === tournament.id ? primaryColor : 'rgba(139, 92, 246, 0.2)'}; position: relative; overflow: hidden; cursor: pointer;" onclick="selectTournament('${tournament.id}')">
                        <div style="position: absolute; top: 0; left: 0; width: 6px; height: 100%; background: linear-gradient(180deg, ${primaryColor} 0%, ${secondaryColor} 100%);"></div>
                        ${selectedTournamentId === tournament.id ? `
                          <div style="position: absolute; top: 16px; right: 16px;">
                            <span class="badge" style="background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); color: white;">âœ“ SELECTED</span>
                          </div>
                        ` : ''}
                        <div style="display: flex; justify-content: space-between; align-items: start; gap: 24px;">
                          <div style="flex: 1;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                              ${tournament.tournament_logo ? `<img src="${tournament.tournament_logo}" style="width: 40px; height: 40px; border-radius: 8px; object-fit: cover;">` : `<span style="font-size: ${fontSize * 2}px;">ğŸ†</span>`}
                              <h4 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700;">${tournament.tournament_name}</h4>
                            </div>
                            <div style="display: flex; gap: 16px; flex-wrap: wrap;">
                              <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6;">ğŸ“…</span>
                                <span style="font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6;">${new Date(tournament.created_at).toLocaleDateString()}</span>
                              </div>
                            </div>
                          </div>
                          <button onclick="event.stopPropagation(); deleteTournament('${tournament.id}')" style="background-color: rgba(239, 68, 68, 0.1); color: #ef4444; padding: 12px 20px; border-radius: 10px; border: 2px solid rgba(239, 68, 68, 0.3); cursor: pointer; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 600; transition: all 0.2s;" onmouseover="this.style.backgroundColor='#ef4444'; this.style.color='white'" onmouseout="this.style.backgroundColor='rgba(239, 68, 68, 0.1)'; this.style.color='#ef4444'">Delete</button>
                        </div>
                      </div>
                    `).join('')}
                  </div>
                `}
              </div>
            </div>
          </div>
        `;
      } else if (currentView === 'teams') {
        mainContent = `
          <div class="p-8">
            <div class="mb-8">
              <h2 style="font-size: ${fontSize * 2.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 800; margin-bottom: 8px;">ğŸ‘¥ Teams</h2>
              <p style="font-size: ${fontSize * 1.125}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6;">Register and manage team rosters</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
              <div class="lg:col-span-1">
                <div style="background-color: ${surfaceColor}; padding: 32px; border-radius: 24px; border: 2px solid rgba(6, 182, 212, 0.2); position: sticky; top: 20px;">
                  <h3 style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 24px;">Register Team</h3>
                  <form id="team-form" onsubmit="handleTeamSubmit(event)">
                    <label for="team-name" style="display: block; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8;">Team Name</label>
                    <input type="text" id="team-name" required style="width: 100%; padding: 16px; background-color: ${bgColor}; border: 2px solid rgba(6, 182, 212, 0.3); border-radius: 12px; margin-bottom: 20px; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; transition: all 0.2s;" onfocus="this.style.borderColor='${secondaryColor}'" onblur="this.style.borderColor='rgba(6, 182, 212, 0.3)'">
                    
                    <label for="team-members" style="display: block; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8;">Team Members</label>
                    <input type="text" id="team-members" placeholder="Player 1, Player 2, Player 3" required style="width: 100%; padding: 16px; background-color: ${bgColor}; border: 2px solid rgba(6, 182, 212, 0.3); border-radius: 12px; margin-bottom: 20px; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; transition: all 0.2s;" onfocus="this.style.borderColor='${secondaryColor}'" onblur="this.style.borderColor='rgba(6, 182, 212, 0.3)'">
                    
                    <label for="team-logo" style="display: block; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8;">Team Logo</label>
                    <input type="file" id="team-logo" accept="image/*" style="width: 100%; padding: 12px; background-color: ${bgColor}; border: 2px solid rgba(6, 182, 212, 0.3); border-radius: 12px; margin-bottom: 24px; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor};">
                    
                    <button type="submit" id="team-submit-btn" style="width: 100%; background: linear-gradient(135deg, ${secondaryColor} 0%, ${primaryColor} 100%); color: white; padding: 16px 32px; border-radius: 12px; border: none; cursor: pointer; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 700; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">Register Team</button>
                  </form>
                </div>
              </div>

              <div class="lg:col-span-2">
                ${teams.length === 0 ? `
                  <div style="background-color: ${surfaceColor}; padding: 80px 40px; border-radius: 24px; text-align: center; border: 2px dashed rgba(6, 182, 212, 0.3);">
                    <div style="font-size: ${fontSize * 5}px; margin-bottom: 24px; opacity: 0.5;">ğŸ‘¥</div>
                    <h4 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px;">No Teams Registered</h4>
                    <p style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6;">Register your first team to get started</p>
                  </div>
                ` : `
                  <div class="space-y-4">
                    ${teams.map(team => `
                      <div style="background-color: ${surfaceColor}; padding: 32px; border-radius: 20px; border: 2px solid rgba(6, 182, 212, 0.2); position: relative; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: 0; width: 6px; height: 100%; background: linear-gradient(180deg, ${secondaryColor} 0%, ${primaryColor} 100%);"></div>
                        <div style="display: flex; justify-content: space-between; align-items: start; gap: 24px;">
                          <div style="flex: 1;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                              ${team.team_logo ? `<img src="${team.team_logo}" style="width: 40px; height: 40px; border-radius: 8px; object-fit: cover;">` : `<span style="font-size: ${fontSize * 2}px;">ğŸ‘¥</span>`}
                              <h4 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700;">${team.team_name}</h4>
                            </div>
                            <div style="background-color: ${bgColor}; padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                              <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 600;">Roster</div>
                              <div style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; line-height: 1.6;">${team.team_members}</div>
                            </div>
                            <div style="font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.5;">
                              ğŸ“… Registered ${new Date(team.created_at).toLocaleDateString()}
                            </div>
                          </div>
                          <button onclick="deleteTeam('${team.id}')" style="background-color: rgba(239, 68, 68, 0.1); color: #ef4444; padding: 12px 20px; border-radius: 10px; border: 2px solid rgba(239, 68, 68, 0.3); cursor: pointer; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 600; transition: all 0.2s;" onmouseover="this.style.backgroundColor='#ef4444'; this.style.color='white'" onmouseout="this.style.backgroundColor='rgba(239, 68, 68, 0.1)'; this.style.color='#ef4444'">Delete</button>
                        </div>
                      </div>
                    `).join('')}
                  </div>
                `}
              </div>
            </div>
          </div>
        `;
      } else if (currentView === 'schedule') {
        mainContent = `
          <div class="p-8">
            <div class="mb-8">
              <h2 style="font-size: ${fontSize * 2.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 800; margin-bottom: 8px;">ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ Schedule</h2>
              <p style="font-size: ${fontSize * 1.125}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6;">Create and manage match schedules</p>
            </div>

            ${teams.length < 2 ? `
              <div style="background-color: ${surfaceColor}; padding: 80px 40px; border-radius: 24px; text-align: center; border: 2px dashed rgba(139, 92, 246, 0.3);">
                <div style="font-size: ${fontSize * 5}px; margin-bottom: 24px; opacity: 0.5;">ğŸ“…</div>
                <h4 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px;">Need More Teams</h4>
                <p style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; margin-bottom: 24px;">Register at least 2 teams to create matches</p>
                <button onclick="switchView('teams')" style="background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); color: white; padding: 16px 32px; border-radius: 12px; border: none; cursor: pointer; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 700;">Register Teams</button>
              </div>
            ` : `
              <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1">
                  <div style="background-color: ${surfaceColor}; padding: 32px; border-radius: 24px; border: 2px solid rgba(139, 92, 246, 0.2); position: sticky; top: 20px;">
                    <h3 style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 24px;">Schedule Match</h3>
                    <form id="match-form" onsubmit="handleMatchSubmit(event)">
                      <label for="match-round" style="display: block; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8;">Round/Stage</label>
                      <input type="text" id="match-round" placeholder="e.g., Quarter Final" required style="width: 100%; padding: 16px; background-color: ${bgColor}; border: 2px solid rgba(139, 92, 246, 0.3); border-radius: 12px; margin-bottom: 20px; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; transition: all 0.2s;" onfocus="this.style.borderColor='${primaryColor}'" onblur="this.style.borderColor='rgba(139, 92, 246, 0.3)'">

                      <label for="match-date" style="display: block; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8;">Match Date & Time</label>
                      <input type="datetime-local" id="match-date" required style="width: 100%; padding: 12px; background-color: ${bgColor}; border: 2px solid rgba(139, 92, 246, 0.3); border-radius: 12px; margin-bottom: 20px; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; transition: all 0.2s;" onfocus="this.style.borderColor='${primaryColor}'" onblur="this.style.borderColor='rgba(139, 92, 246, 0.3)'">
                      
                      <label for="team1-select" style="display: block; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8;">Team 1</label>
                      <select id="team1-select" required style="width: 100%; padding: 16px; background-color: ${bgColor}; border: 2px solid rgba(139, 92, 246, 0.3); border-radius: 12px; margin-bottom: 20px; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; cursor: pointer;">
                        <option value="">Select Team 1</option>
                        ${teams.map(team => `<option value="${team.team_name}">${team.team_name}</option>`).join('')}
                      </select>
                      
                      <label for="team2-select" style="display: block; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8;">Team 2</label>
                      <select id="team2-select" required style="width: 100%; padding: 16px; background-color: ${bgColor}; border: 2px solid rgba(139, 92, 246, 0.3); border-radius: 12px; margin-bottom: 24px; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; cursor: pointer;">
                        <option value="">Select Team 2</option>
                        ${teams.map(team => `<option value="${team.team_name}">${team.team_name}</option>`).join('')}
                      </select>
                      
                      <button type="submit" id="match-submit-btn" style="width: 100%; background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); color: white; padding: 16px 32px; border-radius: 12px; border: none; cursor: pointer; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 700; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">Schedule Match</button>
                    </form>
                  </div>
                </div>

                <div class="lg:col-span-2">
                  ${matches.length === 0 ? `
                    <div style="background-color: ${surfaceColor}; padding: 80px 40px; border-radius: 24px; text-align: center; border: 2px dashed rgba(139, 92, 246, 0.3);">
                      <div style="font-size: ${fontSize * 5}px; margin-bottom: 24px; opacity: 0.5;">ğŸ“…</div>
                      <h4 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px;">No Matches Scheduled</h4>
                      <p style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6;">Create your first match to get started</p>
                    </div>
                  ` : `
                    <div class="space-y-4">
                      ${matches.map(match => `
                        <div class="card-hover" style="background: linear-gradient(135deg, ${surfaceColor} 0%, ${surfaceColor} 100%); padding: 32px; border-radius: 20px; border: 2px solid rgba(139, 92, 246, 0.2); position: relative; overflow: hidden; transition: transform 0.18s, box-shadow 0.18s; box-shadow: 0 6px 20px rgba(2,6,23,0.35);">
                          <div style="position: absolute; top: 16px; right: 16px;">
                            ${match.status === 'completed' 
                              ? `<span class="badge" style="background-color: ${primaryColor}; color: white;">âœ“ COMPLETED</span>`
                              : `<span class="badge" style="background-color: rgba(139, 92, 246, 0.08); color: ${primaryColor}; border: 1px solid rgba(139,92,246,0.12);">â± PENDING</span>`
                            }
                          </div>
                          
                          <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.5; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 700;">${match.match_round}</div>
                          <div style="font-size: ${fontSize * 0.875}px; color: ${textColor}; opacity: 0.75; margin-bottom: 16px;">ğŸ“… ${formatMatchDate(match.match_date || match.created_at)}</div>
                          
                          <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 24px; align-items: center; margin-bottom: 20px;">
                            <div style="text-align: right;">
                              ${(() => {
                                const t1 = teams.find(t => t.team_name === match.team1);
                                return t1?.team_logo ? `<img src="${t1.team_logo}" style="width: 36px; height: 36px; border-radius: 6px; object-fit: cover; margin-bottom: 8px; display: block; margin-left: auto;">` : '';
                              })()}
                              <div style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 8px;">${match.team1}</div>
                              ${match.status === 'completed' ? `
                                <div style="font-size: ${fontSize * 2}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${primaryColor}; font-weight: 800;">${match.score1}</div>
                              ` : ''}
                            </div>
                            
                            <div style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.3; font-weight: 800;">VS</div>
                            
                            <div style="text-align: left;">
                              ${(() => {
                                const t2 = teams.find(t => t.team_name === match.team2);
                                return t2?.team_logo ? `<img src="${t2.team_logo}" style="width: 36px; height: 36px; border-radius: 6px; object-fit: cover; margin-bottom: 8px;">` : '';
                              })()}
                              <div style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 8px;">${match.team2}</div>
                              ${match.status === 'completed' ? `
                                <div style="font-size: ${fontSize * 2}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${primaryColor}; font-weight: 800;">${match.score2}</div>
                              ` : ''}
                            </div>
                          </div>
                          
                          <button onclick="deleteMatch('${match.id}')" style="width: 100%; background-color: rgba(239, 68, 68, 0.1); color: #ef4444; padding: 12px; border-radius: 10px; border: 2px solid rgba(239, 68, 68, 0.3); cursor: pointer; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 600; transition: all 0.2s;" onmouseover="this.style.backgroundColor='#ef4444'; this.style.color='white'" onmouseout="this.style.backgroundColor='rgba(239, 68, 68, 0.1)'; this.style.color='#ef4444'">Delete Match</button>
                        </div>
                      `).join('')}
                    </div>
                  `}
                </div>
              </div>
            `}
          </div>
        `;
      } else if (currentView === 'results') {
        mainContent = `
          <div class="p-8">
            <div class="mb-8">
              <h2 style="font-size: ${fontSize * 2.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 800; margin-bottom: 8px;">ğŸ“Š Results</h2>
              <p style="font-size: ${fontSize * 1.125}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6;">Update and track match outcomes</p>
            </div>

            ${matches.length === 0 ? `
              <div style="background-color: ${surfaceColor}; padding: 80px 40px; border-radius: 24px; text-align: center; border: 2px dashed rgba(139, 92, 246, 0.3);">
                <div style="font-size: ${fontSize * 5}px; margin-bottom: 24px; opacity: 0.5;">ğŸ“Š</div>
                <h4 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px;">No Matches to Track</h4>
                <p style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; margin-bottom: 24px;">Schedule some matches first to track results</p>
                <button onclick="switchView('schedule')" style="background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); color: white; padding: 16px 32px; border-radius: 12px; border: none; cursor: pointer; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 700;">Go to Schedule</button>
              </div>
            ` : `
              <div class="space-y-8">
                ${pendingMatches.length > 0 ? `
                  <div>
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 24px;">
                      <h3 style="font-size: ${fontSize * 1.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 800;">â± Pending Matches</h3>
                      <span class="badge" style="background-color: rgba(139, 92, 246, 0.2); color: ${primaryColor};">${pendingMatches.length}</span>
                    </div>
                    <div class="space-y-4">
                      ${pendingMatches.map(match => `
                        <div style="background-color: ${surfaceColor}; padding: 32px; border-radius: 20px; border: 2px solid rgba(139, 92, 246, 0.2);">
                          <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.5; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 700;">${match.match_round}</div>
                          <div style="font-size: ${fontSize * 0.875}px; color: ${textColor}; opacity: 0.75; margin-bottom: 12px;">ğŸ“… ${formatMatchDate(match.match_date || match.created_at)}</div>
                          
                          <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 24px; align-items: center; margin-bottom: 24px;">
                            <div style="text-align: right;">
                              ${(() => {
                                const t1 = teams.find(t => t.team_name === match.team1);
                                return t1?.team_logo ? `<img src="${t1.team_logo}" style="width: 40px; height: 40px; border-radius: 6px; object-fit: cover; margin-bottom: 8px; display: block; margin-left: auto;">` : '';
                              })()}
                              <div style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700;">${match.team1}</div>
                            </div>
                            <div style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.3; font-weight: 800;">VS</div>
                            <div style="text-align: left;">
                              ${(() => {
                                const t2 = teams.find(t => t.team_name === match.team2);
                                return t2?.team_logo ? `<img src="${t2.team_logo}" style="width: 40px; height: 40px; border-radius: 6px; object-fit: cover; margin-bottom: 8px;">` : '';
                              })()}
                              <div style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700;">${match.team2}</div>
                            </div>
                          </div>
                          
                          <form id="result-form-${match.id}" onsubmit="handleResultSubmit(event, '${match.id}')">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                              <div>
                                <label for="score1-${match.id}" style="display: block; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8;">${match.team1} Score</label>
                                <input type="number" id="score1-${match.id}" min="0" required style="width: 100%; padding: 16px; background-color: ${bgColor}; border: 2px solid rgba(139, 92, 246, 0.3); border-radius: 12px; font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; text-align: center;">
                              </div>
                              <div>
                                <label for="score2-${match.id}" style="display: block; font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8;">${match.team2} Score</label>
                                <input type="number" id="score2-${match.id}" min="0" required style="width: 100%; padding: 16px; background-color: ${bgColor}; border: 2px solid rgba(139, 92, 246, 0.3); border-radius: 12px; font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; text-align: center;">
                              </div>
                            </div>
                            <button type="submit" id="result-submit-${match.id}" style="width: 100%; background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); color: white; padding: 16px 32px; border-radius: 12px; border: none; cursor: pointer; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 700; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">Submit Result</button>
                          </form>
                        </div>
                      `).join('')}
                    </div>
                  </div>
                ` : ''}

                ${completedMatches.length > 0 ? `
                  <div>
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 24px;">
                      <h3 style="font-size: ${fontSize * 1.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 800;">âœ“ Completed Matches</h3>
                      <span class="badge" style="background-color: ${primaryColor}; color: white;">${completedMatches.length}</span>
                    </div>
                    <div class="space-y-4">
                      ${completedMatches.map(match => {
                        const winner = match.score1 > match.score2 ? match.team1 : match.score2 > match.score1 ? match.team2 : null;
                        return `
                          <div style="background: linear-gradient(135deg, ${surfaceColor} 0%, ${bgColor} 100%); padding: 32px; border-radius: 20px; border: 2px solid ${winner ? primaryColor : secondaryColor}; position: relative; overflow: hidden;">
                            ${winner ? `
                              <div style="position: absolute; top: 0; right: 0; background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); color: white; padding: 8px 20px; border-bottom-left-radius: 12px; font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em;">ğŸ† ${winner} WINS</div>
                            ` : `
                              <div style="position: absolute; top: 0; right: 0; background-color: ${secondaryColor}; color: white; padding: 8px 20px; border-bottom-left-radius: 12px; font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em;">DRAW</div>
                            `}
                            
                            <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.5; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 700;">${match.match_round}</div>
                            
                            <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 32px; align-items: center;">
                              <div style="text-align: right;">
                                ${(() => {
                                  const t1 = teams.find(t => t.team_name === match.team1);
                                  return t1?.team_logo ? `<img src="${t1.team_logo}" style="width: 44px; height: 44px; border-radius: 6px; object-fit: cover; margin-bottom: 12px; display: block; margin-left: auto;">` : '';
                                })()}
                                <div style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px; ${winner === match.team1 ? `color: ${primaryColor};` : ''}">${match.team1}</div>
                                <div style="font-size: ${fontSize * 3}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${winner === match.team1 ? primaryColor : textColor}; font-weight: 800; opacity: ${winner === match.team1 ? '1' : '0.5'};">${match.score1}</div>
                              </div>
                              
                              <div style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.2; font-weight: 800;">-</div>
                              
                              <div style="text-align: left;">
                                ${(() => {
                                  const t2 = teams.find(t => t.team_name === match.team2);
                                  return t2?.team_logo ? `<img src="${t2.team_logo}" style="width: 44px; height: 44px; border-radius: 6px; object-fit: cover; margin-bottom: 12px;">` : '';
                                })()}
                                <div style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px; ${winner === match.team2 ? `color: ${primaryColor};` : ''}">${match.team2}</div>
                                <div style="font-size: ${fontSize * 3}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${winner === match.team2 ? primaryColor : textColor}; font-weight: 800; opacity: ${winner === match.team2 ? '1' : '0.5'};">${match.score2}</div>
                              </div>
                            </div>
                          </div>
                        `;
                      }).join('')}
                    </div>
                  </div>
                ` : ''}
              </div>
            `}
          </div>
        `;
      } else if (currentView === 'pointstable') {
        const pointsTable = calculatePointsTable();
        
        mainContent = `
          <div class="p-8">
            <div class="mb-8">
              <h2 style="font-size: ${fontSize * 2.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 800; margin-bottom: 8px;">ğŸ… Points Table</h2>
              <p style="font-size: ${fontSize * 1.125}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6;">Team standings and rankings</p>
            </div>

            ${teams.length === 0 ? `
              <div style="background-color: ${surfaceColor}; padding: 80px 40px; border-radius: 24px; text-align: center; border: 2px dashed rgba(139, 92, 246, 0.3);">
                <div style="font-size: ${fontSize * 5}px; margin-bottom: 24px; opacity: 0.5;">ğŸ…</div>
                <h4 style="font-size: ${fontSize * 1.5}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700; margin-bottom: 12px;">No Teams Available</h4>
                <p style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; margin-bottom: 24px;">Register teams to see the points table</p>
                <button onclick="switchView('teams')" style="background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); color: white; padding: 16px 32px; border-radius: 12px; border: none; cursor: pointer; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 700;">Register Teams</button>
              </div>
            ` : `
              <div style="background-color: ${surfaceColor}; border-radius: 24px; overflow: hidden; border: 2px solid rgba(139, 92, 246, 0.2);">
                <!-- Table Header -->
                <div style="background: linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%); padding: 20px 32px; display: grid; grid-template-columns: 60px 1fr repeat(8, 80px); gap: 16px; align-items: center;">
                  <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em;">#</div>
                  <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em;">Team</div>
                  <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; text-align: center;">P</div>
                  <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; text-align: center;">W</div>
                  <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; text-align: center;">D</div>
                  <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; text-align: center;">L</div>
                  <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; text-align: center;">GF</div>
                  <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; text-align: center;">GA</div>
                  <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; text-align: center;">GD</div>
                  <div style="font-size: ${fontSize * 0.75}px; font-family: ${fontFamily}, system-ui, sans-serif; color: white; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; text-align: center;">PTS</div>
                </div>

                <!-- Table Body -->
                ${pointsTable.map((team, index) => {
                  const isTop3 = index < 3;
                  const rankEmoji = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : '';
                  
                  return `
                    <div style="padding: 24px 32px; display: grid; grid-template-columns: 60px 1fr repeat(8, 80px); gap: 16px; align-items: center; border-top: 2px solid rgba(139, 92, 246, 0.1); ${isTop3 ? `background: linear-gradient(90deg, rgba(139, 92, 246, 0.05) 0%, transparent 100%);` : ''}">
                      <div style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${isTop3 ? primaryColor : textColor}; font-weight: 800;">
                        ${rankEmoji || (index + 1)}
                      </div>
                      <div style="display: flex; align-items: center; gap: 12px;">
                        ${team.team_logo ? `<img src="${team.team_logo}" style="width: 40px; height: 40px; border-radius: 8px; object-fit: cover;">` : `<span style="font-size: ${fontSize * 1.5}px;">âš½</span>`}
                        <span style="font-size: ${fontSize * 1.125}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 700;">
                          ${team.name}
                        </span>
                      </div>
                      <div style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; text-align: center; opacity: 0.8;">${team.played}</div>
                      <div style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: #10b981; text-align: center; font-weight: 600;">${team.won}</div>
                      <div style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${secondaryColor}; text-align: center; font-weight: 600;">${team.drawn}</div>
                      <div style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: #ef4444; text-align: center; font-weight: 600;">${team.lost}</div>
                      <div style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; text-align: center; opacity: 0.8;">${team.goalsFor}</div>
                      <div style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; text-align: center; opacity: 0.8;">${team.goalsAgainst}</div>
                      <div style="font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${team.goalDifference >= 0 ? '#10b981' : '#ef4444'}; text-align: center; font-weight: 600;">
                        ${team.goalDifference >= 0 ? '+' : ''}${team.goalDifference}
                      </div>
                      <div style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${primaryColor}; text-align: center; font-weight: 800;">
                        ${team.points}
                      </div>
                    </div>
                  `;
                }).join('')}
              </div>

              <!-- Legend -->
              <div style="margin-top: 32px; background-color: ${surfaceColor}; padding: 24px 32px; border-radius: 16px; border: 2px solid rgba(139, 92, 246, 0.1);">
                <div style="font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6; margin-bottom: 16px; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 700;">Legend</div>
                <div style="display: grid; grid-cols-2 md:grid-cols-4 gap-16;">
                  <div><span style="font-weight: 700; color: ${textColor};">P:</span> <span style="color: ${textColor}; opacity: 0.7;">Played</span></div>
                  <div><span style="font-weight: 700; color: ${textColor};">W:</span> <span style="color: ${textColor}; opacity: 0.7;">Won</span></div>
                  <div><span style="font-weight: 700; color: ${textColor};">D:</span> <span style="color: ${textColor}; opacity: 0.7;">Drawn</span></div>
                  <div><span style="font-weight: 700; color: ${textColor};">L:</span> <span style="color: ${textColor}; opacity: 0.7;">Lost</span></div>
                  <div><span style="font-weight: 700; color: ${textColor};">GF:</span> <span style="color: ${textColor}; opacity: 0.7;">Goals For</span></div>
                  <div><span style="font-weight: 700; color: ${textColor};">GA:</span> <span style="color: ${textColor}; opacity: 0.7;">Goals Against</span></div>
                  <div><span style="font-weight: 700; color: ${textColor};">GD:</span> <span style="color: ${textColor}; opacity: 0.7;">Goal Difference</span></div>
                  <div><span style="font-weight: 700; color: ${textColor};">PTS:</span> <span style="color: ${textColor}; opacity: 0.7;">Points</span></div>
                </div>
                <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(139, 92, 246, 0.1); font-size: ${fontSize * 0.875}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; opacity: 0.6;">
                  ğŸ’¡ Win = 3 points | Draw = 1 point | Loss = 0 points
                </div>
              </div>
            `}
          </div>
        `;
      }

      app.innerHTML = `
        <div class="app-container" style="display: flex; min-height: 100%; background-color: ${bgColor};">
          <aside class="sidebar" style="width: 280px; background-color: ${surfaceColor}; padding: 32px 24px; border-right: 2px solid rgba(139, 92, 246, 0.1); flex-shrink: 0;">
            <div style="margin-bottom: 48px; white-space: nowrap;">
              <div style="font-size: ${fontSize * 2}px; margin-bottom: 8px;">ğŸ†</div>
              <h3 style="font-size: ${fontSize * 1.25}px; font-family: ${fontFamily}, system-ui, sans-serif; color: ${textColor}; font-weight: 800;">Tournament Pro</h3>
            </div>
            
            <nav style="display: flex; flex-direction: column;">
              <div class="nav-item" onclick="switchView('dashboard')" style="padding: 16px 20px; margin-bottom: 8px; border-radius: 12px; background-color: ${currentView === 'dashboard' ? `${primaryColor}` : 'transparent'}; color: ${currentView === 'dashboard' ? 'white' : textColor}; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 600; white-space: nowrap;">
                <span style="margin-right: 12px;">ğŸ </span> Dashboard
              </div>
              <div class="nav-item" onclick="switchView('tournaments')" style="padding: 16px 20px; margin-bottom: 8px; border-radius: 12px; background-color: ${currentView === 'tournaments' ? `${primaryColor}` : 'transparent'}; color: ${currentView === 'tournaments' ? 'white' : textColor}; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 600; white-space: nowrap;">
                <span style="margin-right: 12px;">ğŸ†</span> Tournaments
              </div>
              <div class="nav-item" onclick="switchView('teams')" style="padding: 16px 20px; margin-bottom: 8px; border-radius: 12px; background-color: ${currentView === 'teams' ? `${primaryColor}` : 'transparent'}; color: ${currentView === 'teams' ? 'white' : textColor}; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 600; white-space: nowrap;">
                <span style="margin-right: 12px;">ğŸ‘¥</span> Teams
              </div>
              <div class="nav-item" onclick="switchView('schedule')" style="padding: 16px 20px; margin-bottom: 8px; border-radius: 12px; background-color: ${currentView === 'schedule' ? `${primaryColor}` : 'transparent'}; color: ${currentView === 'schedule' ? 'white' : textColor}; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 600; white-space: nowrap;">
                <span style="margin-right: 12px;">ğŸ“…</span> Schedule
              </div>
              <div class="nav-item" onclick="switchView('results')" style="padding: 16px 20px; margin-bottom: 8px; border-radius: 12px; background-color: ${currentView === 'results' ? `${primaryColor}` : 'transparent'}; color: ${currentView === 'results' ? 'white' : textColor}; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 600; white-space: nowrap;">
                <span style="margin-right: 12px;">ğŸ“Š</span> Results
              </div>
              <div class="nav-item" onclick="switchView('pointstable')" style="padding: 16px 20px; margin-bottom: 8px; border-radius: 12px; background-color: ${currentView === 'pointstable' ? `${primaryColor}` : 'transparent'}; color: ${currentView === 'pointstable' ? 'white' : textColor}; font-size: ${fontSize}px; font-family: ${fontFamily}, system-ui, sans-serif; font-weight: 600; white-space: nowrap;">
                <span style="margin-right: 12px;">ğŸ…</span> Points Table
              </div>
            </nav>
          </aside>
          
          <main class="main-content" style="flex: 1; overflow-y: auto; width: 100%;">
            ${mainContent}
          </main>
        </div>
      `;
    }

    function switchView(view) {
      currentView = view;
      renderApp();
    }

    function calculatePointsTable() {
      const teamStats = {};
      
      // Initialize stats for all teams
      teams.forEach(team => {
        teamStats[team.team_name] = {
          name: team.team_name,
          team_logo: team.team_logo,
          played: 0,
          won: 0,
          lost: 0,
          drawn: 0,
          goalsFor: 0,
          goalsAgainst: 0,
          goalDifference: 0,
          points: 0
        };
      });

      // Get completed matches from allData
      const completedMatchesList = allData.filter(item => item.type === 'match' && item.status === 'completed');

      // Calculate stats from completed matches
      completedMatchesList.forEach(match => {
        const team1Stats = teamStats[match.team1];
        const team2Stats = teamStats[match.team2];

        if (team1Stats && team2Stats) {
          team1Stats.played++;
          team2Stats.played++;
          
          const score1 = Number(match.score1) || 0;
          const score2 = Number(match.score2) || 0;
          
          team1Stats.goalsFor += score1;
          team1Stats.goalsAgainst += score2;
          team2Stats.goalsFor += score2;
          team2Stats.goalsAgainst += score1;

          if (score1 > score2) {
            team1Stats.won++;
            team1Stats.points += 3;
            team2Stats.lost++;
          } else if (score2 > score1) {
            team2Stats.won++;
            team2Stats.points += 3;
            team1Stats.lost++;
          } else {
            team1Stats.drawn++;
            team2Stats.drawn++;
            team1Stats.points += 1;
            team2Stats.points += 1;
          }

          team1Stats.goalDifference = team1Stats.goalsFor - team1Stats.goalsAgainst;
          team2Stats.goalDifference = team2Stats.goalsFor - team2Stats.goalsAgainst;
        }
      });

      // Convert to array and sort by points, then goal difference, then goals for
      return Object.values(teamStats)
        .sort((a, b) => {
          if (b.points !== a.points) return b.points - a.points;
          if (b.goalDifference !== a.goalDifference) return b.goalDifference - a.goalDifference;
          return b.goalsFor - a.goalsFor;
        });
    }

    function selectTournament(tournamentId) {
      selectedTournamentId = tournamentId;
      renderApp();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function clearTournamentSelection() {
      selectedTournamentId = null;
      renderApp();
    }

    async function handleTournamentSubmit(event) {
      event.preventDefault();
      
      if (tournaments.length >= 999) {
        showToast("Maximum limit of 999 tournaments reached.");
        return;
      }

      const submitBtn = document.getElementById('tournament-submit-btn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'Creating...';

      const tournamentName = document.getElementById('tournament-name').value;
      const logoFile = document.getElementById('tournament-logo').files[0];
      let logoBase64 = null;

      if (logoFile) {
        try {
          logoBase64 = await fileToBase64(logoFile);
        } catch (err) {
          submitBtn.disabled = false;
          submitBtn.textContent = 'Create Tournament';
          showToast('Failed to process logo. Please try again.');
          return;
        }
      }

      const result = await window.dataSdk.create({
        id: Date.now().toString(),
        type: 'tournament',
        tournament_name: tournamentName,
        tournament_logo: logoBase64,
        created_at: new Date().toISOString()
      });

      submitBtn.disabled = false;
      submitBtn.textContent = 'Create Tournament';

      if (result.isOk) {
        document.getElementById('tournament-form').reset();
        showToast('Tournament created successfully! ğŸ‰');
      } else {
        showToast('Failed to create tournament.');
      }
    }

    async function handleTeamSubmit(event) {
      event.preventDefault();
      
      if (allData.filter(item => item.type === 'team').length >= 999) {
        showToast("Maximum limit of 999 teams reached.");
        return;
      }

      const submitBtn = document.getElementById('team-submit-btn');
      const originalText = submitBtn.textContent;
      submitBtn.disabled = true;
      submitBtn.textContent = 'Registering...';

      const teamName = document.getElementById('team-name').value;
      const teamMembers = document.getElementById('team-members').value;
      const logoFile = document.getElementById('team-logo').files[0];
      let logoBase64 = null;

      if (logoFile) {
        try {
          logoBase64 = await fileToBase64(logoFile);
        } catch (err) {
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
          showToast('Failed to process logo. Please try again.');
          return;
        }
      }

      const result = await window.dataSdk.create({
        id: Date.now().toString() + '-team',
        type: 'team',
        team_name: teamName,
        team_members: teamMembers,
        team_logo: logoBase64,
        created_at: new Date().toISOString()
      });

      if (result.isOk) {
        document.getElementById('team-form').reset();
        showToast('Team registered successfully! ğŸ‰');
      } else {
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
        showToast('Failed to register team. Please try again.');
      }
    }

    async function handleMatchSubmit(event) {
      event.preventDefault();
      
      if (matches.length >= 999) {
        showToast("Maximum limit of 999 matches reached.");
        return;
      }

      const submitBtn = document.getElementById('match-submit-btn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'Scheduling...';

      const matchRound = document.getElementById('match-round').value;
      const team1 = document.getElementById('team1-select').value;
      const team2 = document.getElementById('team2-select').value;
      const matchDateRaw = document.getElementById('match-date').value;

      if (team1 === team2) {
        showToast('Please select two different teams.');
        submitBtn.disabled = false;
        submitBtn.textContent = 'Schedule Match';
        return;
      }

      if (!matchDateRaw) {
        showToast('Please select a date and time for the match.');
        submitBtn.disabled = false;
        submitBtn.textContent = 'Schedule Match';
        return;
      }

      const matchDateIso = new Date(matchDateRaw).toISOString();

      const result = await window.dataSdk.create({
        id: Date.now().toString(),
        type: 'match',
        match_round: matchRound,
        team1: team1,
        team2: team2,
        match_date: matchDateIso,
        score1: 0,
        score2: 0,
        status: 'pending',
        created_at: new Date().toISOString()
      });

      submitBtn.disabled = false;
      submitBtn.textContent = 'Schedule Match';

      if (result.isOk) {
        document.getElementById('match-form').reset();
        showToast(`Match scheduled for ${formatMatchDate(matchDateIso)} ğŸ‰`);
      } else {
        showToast('Failed to schedule match.');
      }
    }

    async function handleResultSubmit(event, matchId) {
      event.preventDefault();
      
      const submitBtn = document.getElementById(`result-submit-${matchId}`);
      submitBtn.disabled = true;
      submitBtn.textContent = 'Submitting...';

      const score1 = parseInt(document.getElementById(`score1-${matchId}`).value);
      const score2 = parseInt(document.getElementById(`score2-${matchId}`).value);

      const match = allData.find(m => m.id === matchId);
      if (!match) {
        showToast('Match not found.');
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit Result';
        return;
      }

      const updatedMatch = {
        ...match,
        score1: score1,
        score2: score2,
        status: 'completed'
      };

      const result = await window.dataSdk.update(updatedMatch);

      if (result.isOk) {
        showToast('Result submitted successfully! ğŸ‰');
      } else {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit Result';
        showToast('Failed to submit result.');
      }
    }

    async function deleteTournament(id) {
      const tournament = tournaments.find(t => t.id === id);
      if (!tournament) return;

      const result = await window.dataSdk.delete(tournament);

      if (result.isOk) {
        showToast('Tournament deleted.');
      } else {
        showToast('Failed to delete tournament.');
      }
    }

    async function deleteTeam(id) {
      const team = teams.find(t => t.id === id);
      if (!team) return;

      const result = await window.dataSdk.delete(team);

      if (result.isOk) {
        showToast('Team deleted.');
      } else {
        showToast('Failed to delete team.');
      }
    }

    async function deleteMatch(id) {
      const match = matches.find(m => m.id === id);
      if (!match) return;

      const result = await window.dataSdk.delete(match);

      if (result.isOk) {
        showToast('Match deleted.');
      } else {
        showToast('Failed to delete match.');
      }
    }

    function showToast(message) {
      const config = window.elementSdk?.config || defaultConfig;
      const primaryColor = config.primary_action_color || defaultConfig.primary_action_color;
      const fontFamily = config.font_family || defaultConfig.font_family;
      const fontSize = config.font_size || defaultConfig.font_size;

      const existingToast = document.getElementById('toast');
      if (existingToast) {
        existingToast.remove();
      }

      const toast = document.createElement('div');
      toast.id = 'toast';
      toast.textContent = message;
      toast.style.cssText = `
        position: fixed;
        bottom: 32px;
        right: 32px;
        background: linear-gradient(135deg, ${primaryColor} 0%, #8b5cf6 100%);
        color: white;
        padding: 20px 32px;
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(139, 92, 246, 0.4);
        font-family: ${fontFamily}, system-ui, sans-serif;
        font-size: ${fontSize}px;
        font-weight: 600;
        z-index: 1000;
        animation: slideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      `;

      const style = document.createElement('style');
      style.textContent = `
        @keyframes slideIn {
          from {
            transform: translateX(400px);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        @keyframes slideOut {
          from {
            transform: translateX(0);
            opacity: 1;
          }
          to {
            transform: translateX(400px);
            opacity: 0;
          }
        }
      `;
      document.head.appendChild(style);

      document.body.appendChild(toast);

      setTimeout(() => {
        toast.style.animation = 'slideOut 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }

    // Add SDK mocks before initialization if real SDKs are not loaded
    (function() {
      if (typeof window.dataSdk === 'undefined') {
        const localData = [];
        let dataHandler = null;
        
        window.dataSdk = {
          init: async (handler) => {
            dataHandler = handler;
            handler.onDataChanged([...localData]);
            return { isOk: true };
          },
          create: async (item) => {
            localData.push(item);
            if (dataHandler) dataHandler.onDataChanged([...localData]);
            return { isOk: true };
          },
          update: async (item) => {
            const index = localData.findIndex(i => i.id === item.id);
            if (index !== -1) localData[index] = item;
            if (dataHandler) dataHandler.onDataChanged([...localData]);
            return { isOk: true };
          },
          delete: async (item) => {
            const index = localData.findIndex(i => i.id === item.id);
            if (index !== -1) localData.splice(index, 1);
            if (dataHandler) dataHandler.onDataChanged([...localData]);
            return { isOk: true };
          }
        };
        console.warn('dataSdk mock loaded - using local in-memory storage');
      }
      if (typeof window.elementSdk === 'undefined') {
        window.elementSdk = {
          config: { 
            background_color: "#f0f4f8",
            surface_color: "#ffffff",
            text_color: "#1e293b",
            primary_action_color: "#3b82f6",
            secondary_action_color: "#64748b",
            font_family: "Inter",
            font_size: 16,
            platform_title: "Tournament Manager",
            welcome_message: "Organize and manage your tournaments"
          },
          init: (options) => {
            window.elementSdk.config = { ...window.elementSdk.config, ...(options.defaultConfig || {}) };
          },
          setConfig: (c) => { 
            window.elementSdk.config = { ...(window.elementSdk.config||{}), ...c }; 
          }
        };
        console.warn('elementSdk mock loaded - using local fallback');
      }
    })();

    initializeApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9aff73ee21d76eef',t:'MTc2NjA2OTIyMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>